<?xml version="1.0" encoding="UTF-8"?>

<!--
 * See the NOTICE file distributed with this work for additional
 * information regarding copyright ownership.
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see http://www.gnu.org/licenses/
-->

<xwikidoc version="1.1">
  <web>DevGuide</web>
  <name>JSONExport</name>
  <language/>
  <defaultLanguage/>
  <translation>0</translation>
  <creator>xwiki:XWiki.Admin</creator>
  <creationDate>1415648653000</creationDate>
  <parent>DevGuide.WebHome</parent>
  <author>xwiki:XWiki.Admin</author>
  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>
  <date>1415757001000</date>
  <contentUpdateDate>1415756983000</contentUpdateDate>
  <version>1.1</version>
  <title>JSON Export</title>
  <comment/>
  <minorEdit>false</minorEdit>
  <syntaxId>xwiki/2.1</syntaxId>
  <hidden>false</hidden>
  <content>{{warning}}This is the first draft. Please report any issues or send your comments to support@phenotips.org and include "JSON Export Documentation" in the subject line.{{/warning}}

The patient records stored in PhenoTips can be exported in a JSON format, which is a format commonly used for automatic parsing by computers. Exporting in JSON format is most suited when an external piece of software or a script needs patient information.

The patient records can be exported either individually or in bulk. To export an individual record, open a patient record, hover over "More actions", and then click "Export JSON". To perform a bulk export, navigate to the "Browse all data" page, click "Export database in JSON format", and follow the instructions.

{{warning}}Bulk JSON export is not yet available, but it is in the final stage of development.{{/warning}}

The following is an explanation of the name/value pairs of an individual patient record in JSON format based on an example. Each line of the name/value pair of the example patient record is presented on the left, with its explanation on the right. Not all of the name/value pairs will necessarily be present. 

|"id": "P0000001",|The id of the patient record generated by PhenoTips. The format is "P" followed by a unique 7 digit combination.
|"external_id": "UDP_1234",|The id given to the patient record by the user.
|"reporter":"Admin",|The user ID of the creator of the patient record. This user could no longer be responsible for or even have access to this patient record.
|(% style="border-top-width: 1px !important" %)"meta": {|(% style="border-top-width: 1px !important" %)A collection of fields describing the patient record at the time it was exported.
|  "phenotips_version": "1.0-milestone-9”,|
|  "hpo_version": "13:03:2014 07:47",|The version of the Human Phenotype Ontology used to specify phenotypes of the patient.
|  "export_date_time_stamp": "2014-01-10T12:00:48-05:00",|
|  "contains_pii": false|##true## if the exported record contains Personally Identifiable Information, otherwise ##false##.
|},|
|(% style="border-top-width: 1px !important" %)"contact":{|(% style="border-top-width: 1px !important" %)The contact information of the clinician responsible for a patient.
|  "user_id":"johndoe",|The PhenoTips user ID of the clinician.
|  "name":"John Doe",|
|  "email":"support@phenotips.org",|
|  "institution":"http://phenotips.org/"|
|},|
|(% style="border-top-width: 1px !important" %)"patient_name":{|(% style="border-top-width: 1px !important" %)Patient name is absent in all research environments.
|  "first_name":"John",|
|  "last_name":"Hopfield"|
|},|
|"sex":"M",|Could be ##F## for female, ##M## for male, and ##U## for unknown.
|"date_of_birth":"1933-07-15",|May be a full or partial date (eg. yyyy, yyyy-MM, or yyyy-MM-dd).
|(% style="border-top-width: 1px !important" %)"ethnicity":{|(% style="border-top-width: 1px !important" %)The ethnicities of the patient's parents presented as a list.
|  "maternal_ethnicity":[|
|    "Polish", "Irish"|
|  ],|
|  "paternal_ethnicity":[|
|    "Japanese"|
|  ]|
|},|
|(% style="border-top-width: 1px !important" %)"family_history":{|(% style="border-top-width: 1px !important" %)Information about the patient's family stated as a either ##true## or ##false##.
|  "consanguinity":true,|
|  "miscarriages":false|
|},|
|(% style="border-top-width: 1px !important" %)"global_mode_of_inheritance":{|(% style="border-top-width: 1px !important" %)Marks the mode of inheritance of the majority of the patient’s disorders and is used in complement with the //suspected_mode_of_inheritance// qualifier that can be optionally associated to each phenotypic feature, and the //mode_of_inheritance// qualifier that can be optionally associated to each disorder.
|  "id":"HP:0001470",|The Human Phenotype Ontology ID of the global mode of inheritance.
|  "label":"Sex-limited autosomal dominant"|
|},|
|"global_age_of_onset":{|Marks the time when the majority of symptoms were first observed and is used in complement with the //age_of_onset// qualifier that can be optionally associated to each feature or disorder.
|  "id":"HP:0003577",|The Human Phenotype Ontology ID of the global age of onset.
|  "label":"Congenital onset"|
|},|
|(% style="border-top-width: 1px !important" %)"prenatal_perinatal_history":{|(% style="border-top-width: 1px !important" %)Information relating to the prenatal and perinatal development stages.
|  "gestation":36,|Gestation given in weeks.
|  "ivf":false,|##true## if In Vitro Fertilization was performed, ##false## otherwise. Not present if unknown.
|  "assistedReproduction_fertilityMeds":true,|##true## if fertility medication was used to conceive the patient, ##false## otherwise. Not present if unknown.
|  "assistedReproduction_surrogacy":true|##true## if the patient is a surrogate child, ##false## otherwise. Not present if unknown.
|},|
|"apgar":{|The APGAR scores at 1 and 5 minutes. If the score is unknown, it will not be present.
|  "apgar1":6,|
|  "apgar5":7|
|},|
|(% style="border-top-width: 1px !important" %)"prenatal_perinatal_phenotype":{|(% style="border-top-width: 1px !important" %)|
|  "prenatal_phenotype":[|The list of prenatal and perinatal phenotypic features which are marked as present.
|    {|
|      "id":"HP:0001622",|
|      "label":"Premature birth"|
|    }|
|  ],|
|  "negative_prenatal_phenotype":[|The list of prenatal and perinatal phenotypic features that are marked as absent.
|    {|
|      "id":"HP:0001561",|
|      "label":"Polyhydramnios"|
|    }|
|  ]|
|}|
|(% style="border-top-width: 1px !important" %)"genes":[|(% style="border-top-width: 1px !important" %)The list of candidate genes with each element in the list having a gene name and a comment attached.
|  {|
|    "gene":"SP3",|
|    "comments":"We have low confidence in this choice"|
|  }|
|],|
|(% style="border-top-width: 1px !important" %)"clinicalStatus":{|(% style="border-top-width: 1px !important" %)The clinical status of the patient which can be either ##affected## or ##unaffected##.
|  "clinicalStatus":"affected"|
|},|
|"features":[|The list of all phenotypes marked in the patient record.
|  {|
|    "id":"HP:0004324",|Human Phenotype Ontology ID of the feature.
|    "label":"Increased body weight",|
|    "type":"phenotype",|
|    "observed":"yes"|
|  },|
|  {|
|    "id":"HP:0000256",|
|    "label":"Macrocephaly",|
|    "type":"phenotype",|
|    "observed":"no"|
|  },|
|]|
|"nonstandard_features":[|List of features that are not contained within the Human Phenotype Ontology, and were entered manually by the user.
|  {|
|    "label":"Self invented feature",|
|    "type":"phenotype",|
|    "observed":"yes",|
|    "categories":[|The category under which the custom/nonstandard feature was created.
|      {|
|        "id":"HP:0000152",|
|        "label":"Abnormality of head or neck"|
|      }|
|    ]|
|  }|
|],|
|(% style="border-top-width: 1px !important" %)"disorders":[|(% style="border-top-width: 1px !important" %)List of all disorders the patient has.
|  {|
|    "id":"MIM:129500",|Online Mendelian Inheritance in Man Ontology ID of the disorder.
|    "label":"#129500 CLOUSTON SYNDROME ;;ECTODERMAL DYSPLASIA 2, CLOUSTON TYPE; ECTD2;; ECTODERMAL DYSPLASIA, HIDROTIC, AUTOSOMAL DOMINANT;; CLOUSTON HIDROTIC ECTODERMAL DYSPLASIA;; ECTODERMAL DYSPLASIA, HIDROTIC, 2, FORMERLY; HED2, FORMERLY"|
|  }|
|],|
|(% style="border-top-width: 1px !important" %)"notes":{|(% style="border-top-width: 1px !important" %)All the note fields in the patient report are united under this section. Generally the name of the field indicates which section the notes are from.
|  "indication_for_referral":"Complaints about pains in the right hemisphere of the brain.",|
|  "family_history":"family history notes",|
|  "prenatal_development":"There are no abnormalities during the prenatal stage of development.",|
|  "medical_history":"There have been some issues with blood flow to the right hemisphere of the brain.",|
|  "diagnosis_notes":"We are unsure about the diagnosis"|
|},|
|(% style="border-top-width: 1px !important" %)"specificity":{|(% style="border-top-width: 1px !important" %)Specificity is a measure of how detailed a phenotypic description is and is affected by two main factors: by the ontology level of phenotypes in the description (eg. abnormal eye physiology vs. glaucoma) and the frequency of occurrence of those phenotypes in the general population. 
|  "score":0.0,|The score in the range of 0 to 1 roughly representing the quality of the phenotypic description of the patient.
|  "date":"2014-11-11T15:01:42.967Z",|
|  "server":"monarchinitiative.org"|
|},|</content>
  <object>
    <name>DevGuide.JSONExport</name>
    <number>0</number>
    <className>XWiki.StyleSheetExtension</className>
    <guid>d55d5463-ec4c-4ea6-a5d6-a85f5cf37dde</guid>
    <class>
      <name>XWiki.StyleSheetExtension</name>
      <customClass/>
      <customMapping/>
      <defaultViewSheet/>
      <defaultEditSheet/>
      <defaultWeb/>
      <nameField/>
      <validationScript/>
      <cache>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>0</multiSelect>
        <name>cache</name>
        <number>5</number>
        <prettyName>Caching policy</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <separators> ,|</separators>
        <size>1</size>
        <unmodifiable>0</unmodifiable>
        <values>long|short|default|forbid</values>
        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
      </cache>
      <code>
        <disabled>0</disabled>
        <name>code</name>
        <number>2</number>
        <prettyName>Code</prettyName>
        <rows>20</rows>
        <size>50</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
      </code>
      <name>
        <disabled>0</disabled>
        <name>name</name>
        <number>1</number>
        <prettyName>Name</prettyName>
        <size>30</size>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>
      </name>
      <parse>
        <disabled>0</disabled>
        <displayFormType>select</displayFormType>
        <displayType>yesno</displayType>
        <name>parse</name>
        <number>4</number>
        <prettyName>Parse content</prettyName>
        <unmodifiable>0</unmodifiable>
        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
      </parse>
      <use>
        <cache>0</cache>
        <disabled>0</disabled>
        <displayType>select</displayType>
        <multiSelect>0</multiSelect>
        <name>use</name>
        <number>3</number>
        <prettyName>Use this extension</prettyName>
        <relationalStorage>0</relationalStorage>
        <separator> </separator>
        <separators> ,|</separators>
        <size>1</size>
        <unmodifiable>0</unmodifiable>
        <values>currentPage=Always on this page|onDemand=On demand|always=Always on this wiki</values>
        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>
      </use>
    </class>
    <property>
      <cache>long</cache>
    </property>
    <property>
      <code>table, td, tr {
  border: 0px solid black !important
}
tr td:first-of-type {
  border-right-width: 1px !important
}
table .box {
  padding: 0 !important
}
</code>
    </property>
    <property>
      <name>Custom table style</name>
    </property>
    <property>
      <parse>0</parse>
    </property>
    <property>
      <use>currentPage</use>
    </property>
  </object>
</xwikidoc>
